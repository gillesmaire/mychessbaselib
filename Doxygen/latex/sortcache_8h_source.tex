\hypertarget{sortcache_8h_source}{}\doxysection{sortcache.\+h}
\mbox{\hyperlink{sortcache_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright (C) 2011  Gerd Lorscheid}}
\DoxyCodeLine{3 \textcolor{comment}{ * Copyright (C) 2011-\/2017  Fulvio Benini}}
\DoxyCodeLine{4 \textcolor{comment}{ *}}
\DoxyCodeLine{5 \textcolor{comment}{ * This file is part of Scid (Shane's Chess Information Database).}}
\DoxyCodeLine{6 \textcolor{comment}{ *}}
\DoxyCodeLine{7 \textcolor{comment}{ * Scid is free software: you can redistribute it and/or modify}}
\DoxyCodeLine{8 \textcolor{comment}{ * it under the terms of the GNU General Public License as published by}}
\DoxyCodeLine{9 \textcolor{comment}{ * the Free Software Foundation.}}
\DoxyCodeLine{10 \textcolor{comment}{ *}}
\DoxyCodeLine{11 \textcolor{comment}{ * Scid is distributed in the hope that it will be useful,}}
\DoxyCodeLine{12 \textcolor{comment}{ * but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{13 \textcolor{comment}{ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{14 \textcolor{comment}{ * GNU General Public License for more details.}}
\DoxyCodeLine{15 \textcolor{comment}{ *}}
\DoxyCodeLine{16 \textcolor{comment}{ * You should have received a copy of the GNU General Public License}}
\DoxyCodeLine{17 \textcolor{comment}{ * along with Scid.  If not, see <http://www.gnu.org/licenses/>.}}
\DoxyCodeLine{18 \textcolor{comment}{ */}}
\DoxyCodeLine{19 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#ifndef SORTCACHE\_H}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#define SORTCACHE\_H}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{common_8h}{common.h}}"{}}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <atomic>}}
\DoxyCodeLine{30 \textcolor{keyword}{using }std::atomic\_bool;}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{class }\mbox{\hyperlink{class_h_filter}{HFilter}};}
\DoxyCodeLine{33 \textcolor{keyword}{class }\mbox{\hyperlink{class_index}{Index}};}
\DoxyCodeLine{34 \textcolor{keyword}{class }\mbox{\hyperlink{class_index_entry}{IndexEntry}};}
\DoxyCodeLine{35 \textcolor{keyword}{class }\mbox{\hyperlink{class_name_base}{NameBase}};}
\DoxyCodeLine{36 }
\DoxyCodeLine{42 \textcolor{keyword}{class }\mbox{\hyperlink{class_sort_cache}{SortCache}} \{}
\DoxyCodeLine{43     \mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} nGames\_;}
\DoxyCodeLine{44     atomic\_bool valid\_fullMap\_;}
\DoxyCodeLine{45     atomic\_bool th\_interrupt\_;}
\DoxyCodeLine{46     \textcolor{keywordtype}{bool} partialHash\_;}
\DoxyCodeLine{47     \mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}}* fullMap\_;}
\DoxyCodeLine{48     \textcolor{keywordtype}{void}* th\_;}
\DoxyCodeLine{49     uint32\_t* hash\_;}
\DoxyCodeLine{50     \textcolor{keyword}{const} \mbox{\hyperlink{class_index}{Index}}* index\_;}
\DoxyCodeLine{51     \textcolor{keyword}{const} \mbox{\hyperlink{class_name_base}{NameBase}}* nbase\_;}
\DoxyCodeLine{52     \textcolor{keywordtype}{char} criteria\_[32];}
\DoxyCodeLine{53     \textcolor{keywordtype}{int} refCount\_;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55     \textcolor{comment}{// Valid fields that can be used to sort the games.}}
\DoxyCodeLine{56     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{57         SORTING\_date =         \textcolor{charliteral}{'d'},}
\DoxyCodeLine{58         SORTING\_year =         \textcolor{charliteral}{'y'},}
\DoxyCodeLine{59         SORTING\_event =        \textcolor{charliteral}{'e'},}
\DoxyCodeLine{60         SORTING\_site =         \textcolor{charliteral}{'s'},}
\DoxyCodeLine{61         SORTING\_round =        \textcolor{charliteral}{'n'},}
\DoxyCodeLine{62         SORTING\_white =        \textcolor{charliteral}{'w'},}
\DoxyCodeLine{63         SORTING\_black =        \textcolor{charliteral}{'b'},}
\DoxyCodeLine{64         SORTING\_eco =          \textcolor{charliteral}{'o'},}
\DoxyCodeLine{65         SORTING\_result =       \textcolor{charliteral}{'r'},}
\DoxyCodeLine{66         SORTING\_moveCount =    \textcolor{charliteral}{'m'},}
\DoxyCodeLine{67         SORTING\_avgElo =       \textcolor{charliteral}{'R'},}
\DoxyCodeLine{68         SORTING\_country =      \textcolor{charliteral}{'c'},}
\DoxyCodeLine{69         SORTING\_deleted =      \textcolor{charliteral}{'D'},}
\DoxyCodeLine{70         SORTING\_eventdate =    \textcolor{charliteral}{'E'},}
\DoxyCodeLine{71         SORTING\_whiteelo =     \textcolor{charliteral}{'W'},}
\DoxyCodeLine{72         SORTING\_blackelo =     \textcolor{charliteral}{'B'},}
\DoxyCodeLine{73         SORTING\_commentcount = \textcolor{charliteral}{'C'},}
\DoxyCodeLine{74         SORTING\_varcount =     \textcolor{charliteral}{'V'},}
\DoxyCodeLine{75         SORTING\_nagcount =     \textcolor{charliteral}{'A'},}
\DoxyCodeLine{76         SORTING\_resultwin =    \textcolor{charliteral}{'1'},}
\DoxyCodeLine{77         SORTING\_resultdraw =   \textcolor{charliteral}{'5'},}
\DoxyCodeLine{78         SORTING\_resultloss =   \textcolor{charliteral}{'0'},}
\DoxyCodeLine{79         SORTING\_rating =       \textcolor{charliteral}{'i'},}
\DoxyCodeLine{80         SORTING\_number =       \textcolor{charliteral}{'N'},}
\DoxyCodeLine{81         SORTING\_sentinel =    \textcolor{charliteral}{'\(\backslash\)0'}}
\DoxyCodeLine{82     \};}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 \textcolor{keyword}{public}:}
\DoxyCodeLine{96     \textcolor{keyword}{static} \mbox{\hyperlink{class_sort_cache}{SortCache}}* \mbox{\hyperlink{class_sort_cache_a7b9a1f42a61f162208d18cdead93cac4}{create}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_index}{Index}}* idx, \textcolor{keyword}{const} \mbox{\hyperlink{class_name_base}{NameBase}}* nb,}
\DoxyCodeLine{97                              \textcolor{keyword}{const} \textcolor{keywordtype}{char}* criteria);}
\DoxyCodeLine{98     \mbox{\hyperlink{class_sort_cache_a47465200de8468fb214c8f28c12f01a0}{\string~SortCache}}();}
\DoxyCodeLine{99 }
\DoxyCodeLine{104     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_sort_cache_a288130f2a7d4bf7c4dbf109094b1147a}{checkForChanges}}(\mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} gameId);}
\DoxyCodeLine{105 }
\DoxyCodeLine{110     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_sort_cache_aa337979182d9c03b412cb05c9418c1af}{prepareForChanges}}() \{ th\_interrupt(); \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{127     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{class_sort_cache_a306bc60483a1af700fe4eefbc40029d8}{select}}(\textcolor{keywordtype}{size\_t} row\_offset, \textcolor{keywordtype}{size\_t} row\_count, \textcolor{keyword}{const} \mbox{\hyperlink{class_h_filter}{HFilter}}\& filter,}
\DoxyCodeLine{128                   \mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}}* result) \textcolor{keyword}{const};}
\DoxyCodeLine{129 }
\DoxyCodeLine{138     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{class_sort_cache_aa874524e0338062d0c776e2dd0aecbb9}{sortedPosition}}(\mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} gameId, \textcolor{keyword}{const} \mbox{\hyperlink{class_h_filter}{HFilter}}\& filter) \textcolor{keyword}{const};}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     \textcolor{keywordtype}{int} \mbox{\hyperlink{class_sort_cache_a286d915c19ce5c5a869fb36ce6707dce}{incrRef}}(\textcolor{keywordtype}{int} incr) \{ \textcolor{keywordflow}{return} refCount\_ += incr; \}}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \textcolor{keyword}{private}:}
\DoxyCodeLine{143     \mbox{\hyperlink{class_sort_cache}{SortCache}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_index}{Index}}* idx, \textcolor{keyword}{const} \mbox{\hyperlink{class_name_base}{NameBase}}* nbase);}
\DoxyCodeLine{144     \mbox{\hyperlink{class_sort_cache}{SortCache}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_sort_cache}{SortCache}}\&);}
\DoxyCodeLine{145     \mbox{\hyperlink{class_sort_cache}{SortCache}}\& operator=(\textcolor{keyword}{const} \mbox{\hyperlink{class_sort_cache}{SortCache}}\&);}
\DoxyCodeLine{146 }
\DoxyCodeLine{147     \textcolor{keyword}{class }CmpLess \{}
\DoxyCodeLine{148         \textcolor{keyword}{const} \mbox{\hyperlink{class_sort_cache}{SortCache}}* sc\_;}
\DoxyCodeLine{149     \textcolor{keyword}{public}:}
\DoxyCodeLine{150         CmpLess(\textcolor{keyword}{const} \mbox{\hyperlink{class_sort_cache}{SortCache}}* sc) : sc\_(sc) \{\}}
\DoxyCodeLine{151         \textcolor{keywordtype}{bool} operator()(\mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} g1, \mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} g2) \textcolor{keyword}{const};}
\DoxyCodeLine{152     \};}
\DoxyCodeLine{153     \textcolor{keywordtype}{int} fullCompare(\mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} left, \mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} right) \textcolor{keyword}{const};}
\DoxyCodeLine{154 }
\DoxyCodeLine{155     uint32\_t calcHash(\mbox{\hyperlink{common_8h_a2c7f83aec3053cd8fc3ab9a70b7eace7}{gamenumT}} gameId);}
\DoxyCodeLine{156     \textcolor{keywordtype}{void} generateHashCache();}
\DoxyCodeLine{157     \textcolor{keywordtype}{void} sortAsynchronously();}
\DoxyCodeLine{158 }
\DoxyCodeLine{159     \textcolor{keywordtype}{void} th\_interrupt() \{}
\DoxyCodeLine{160         th\_interrupt\_ = \textcolor{keyword}{true};}
\DoxyCodeLine{161         th\_join();}
\DoxyCodeLine{162         th\_interrupt\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{163     \}}
\DoxyCodeLine{164     \textcolor{keywordtype}{void} th\_join();}
\DoxyCodeLine{165     \textcolor{keywordtype}{void} th\_sort();}
\DoxyCodeLine{166 \};}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
